<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>basic room filled with fire,smoke and fog</title>
    <link rel="stylesheet" href="css/custom.css">
    <script src="js/three.min.js"></script>
</head>

<body>
<script>
    // TODO: Import sounds
    var scene = new THREE.Scene();
    var camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 1000);
    var renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // camera position
    camera.position.x = 0;
    camera.position.y = 1.55;
    camera.position.z = -10;
    camera.lookAt(new THREE.Vector3(0, 1.2, 10));
</script>

<script src="js/lib/lighting/lighting.js"></script>
<script src="levels/testroom.js"></script>
<script src="js/lib/stats/stats.min.js"></script>

<!-- eased bei positionx gelöscht -->
<script type="x-shader/x-vertex" id="smoke-vertexshader">
    attribute float shift; uniform float time; uniform float size; uniform float lifetime; uniform float projection; varying float progress; float cubicOut( float t ) { float f = t - 1.0; return f * f * f + 1.0; } void main () { progress = fract( time * 2. / lifetime + shift ); float eased = cubicOut( progress ); vec3 pos = vec3( position.x , position.y * eased, position.z ); gl_Position = projectionMatrix * modelViewMatrix * vec4( pos, 1. ); gl_PointSize = ( projection * size ) / gl_Position.w; }


</script>
<script type="x-shader/x-fragment" id="smoke-fragmentshader">
        uniform sampler2D texture; varying float progress; void main() { vec3 color = vec3( 1. ); gl_FragColor = texture2D( texture, gl_PointCoord ) * vec4( color, .3 * ( 1. - progress ) ); }


</script>

<script src="js/lib/fire/VolumetricFire.js"></script>
<script src="js/lib/fire/firePlacement.js"></script>
<script src="js/lib/smoke/smoke.js"></script>

 <!-- fire placement -->
<script>
//    TODO: Feuer einfügen
//    var clock = new THREE.Clock();
//    VolumetricFire.texturePath = '../textures/';
//    var width = window.innerWidth;
//    var height = window.innerHeight;
//    var textureLoader = new THREE.TextureLoader();
//    addFire(0, 2, 0, 1.5, 2, 1.5, 0.5);
//    animateFire();
</script>

<script>
    // Stats
    var stats = new Stats();
    stats.showPanel(0); // 0: fps, 1: ms, 2: mb, 3+: custom
    document.body.appendChild(stats.dom);

    var myfog = 0; // fog counter

    function render() {
        stats.begin();

        requestAnimationFrame(render);

//        camera.position.y += 0.01; // Bewegung nach vorne
//        myfog += 0.0001;
//        scene.fog = new THREE.FogExp2( 0x424242, 0.08 + myfog );

        renderer.render(scene, camera);

        stats.end();
    }
    render();
</script>
</body>

</html>
