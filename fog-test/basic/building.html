<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>basic building round filled with fire</title>
    <link rel="stylesheet" href="css/custom.css">
    <script src="js/three.min.js"></script>
    <script src="js/stats.min.js"></script>
    <script src="js/fire_placement.js"></script>
    <script src="js/VolumetricFire.js"></script>
</head>

<body>
    <script>
    var myfog = 0;
    var scene = new THREE.Scene();
    //var foggrade = 3 * (clock.getElapsedTime() * 0.1);
    //scene.fog = new THREE.FogExp2(0x424242, 0.25 );
    //scene.fog = new THREE.Fog( 0x151515, 0.5, 5.0 ); //added fog
    //var myfog = 0.1;
    //scene.fog = new THREE.FogExp2( 0x424242, 0.4 * myfog );
    var camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 1000);

    var renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    var stats = new Stats();
    stats.showPanel( 0 ); // 0: fps, 1: ms, 2: mb, 3+: custom
    document.body.appendChild( stats.dom );


    var ambientLight = new THREE.AmbientLight(0xffffff, 0.7);
    scene.add(ambientLight);

    var light = new THREE.PointLight(0xffffff, 1, 100);
    light.position.set(0, 3, 0);
    light.power = 2;
    scene.add(light);

    camera.position.x = 0;
    camera.position.y = -2;
    camera.position.z = 1.5;
    camera.lookAt(new THREE.Vector3(0, 5, 0));

    // Load JSON-Objects
    var loader = new THREE.ObjectLoader();
    loader.load("plane.json", function(obj) {
        scene.add(obj);
    });

    // Textureloader
    var texture = new THREE.TextureLoader().load("js/textures/stonefloor.jpg");
    texture.wrapS = THREE.RepeatWrapping;
    texture.wrapT = THREE.RepeatWrapping;
    texture.repeat.set(10, 10);
    var material_floor = new THREE.MeshLambertMaterial({
        map: texture
    });

    texture = new THREE.TextureLoader().load("js/textures/wall.jpg");
    texture.wrapS = THREE.RepeatWrapping;
    texture.wrapT = THREE.RepeatWrapping;
    texture.repeat.set(1, 1);
    var wall = new THREE.MeshStandardMaterial({
        map: texture
    });


    var groundGeometry = new THREE.PlaneGeometry(10, 10);
    var plane = new THREE.Mesh(groundGeometry, material_floor);
    scene.add(plane);

    var right = new THREE.PlaneGeometry(10, 5);
    right.rotateZ(1.57);
    right.rotateY(-1.57);
    right.translate(6, 3, 0.5);
    var plane2 = new THREE.Mesh(right, wall);
    scene.add(plane2)

    var left = new THREE.PlaneGeometry(10, 5);
    left.rotateZ(1.57);
    left.rotateY(1.57);
    left.translate(-6, 3, 0.5);
    var plane3 = new THREE.Mesh(left, wall);
    scene.add(plane3)

    var topGeometry = new THREE.PlaneGeometry(10, 10);
    topGeometry.rotateX(1.57 * 2);
    topGeometry.translate(0, 0, 2.5);
    var plane4 = new THREE.Mesh(topGeometry, wall);
    scene.add(plane4);

    var back = new THREE.PlaneGeometry(10, 5);
    back.rotateX(1.57);
    back.translate(0, 5, 0.5);
    var plane5 = new THREE.Mesh(back, wall);
    scene.add(plane5)

    Addfire(0,-2,0.5);


    function render() {
        stats.begin();
        requestAnimationFrame(render);
        myfog += 0.0001;
        scene.fog = new THREE.FogExp2( 0x424242, 0.0002 + myfog );
        renderer.render(scene, camera);
        stats.end();
    }
    render();
    </script>
</body>

</html>
